(()=>{var e={330:()=>{function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}H5P=H5P||{},H5P.BranchingScenario=function(r,n,i){var a=this;H5P.EventDispatcher.call(a),a.contentId=n,a.startScreen={},a.libraryScreen={},a.endScreens={},a.navigating,a.currentHeight,a.currentId=-1,a.xAPIDataCollector=[],a.userPath=[],a.backwardsAllowedFlags=[],a.proceedButtonInProgress=!1,a.isReverseTransition=!1,a.instances=[];var s=function e(){for(var r=1;r<arguments.length;r++)for(var n in arguments[r])arguments[r].hasOwnProperty(n)&&("object"===t(arguments[0][n])&&"object"===t(arguments[r][n])?e(arguments[0][n],arguments[r][n]):arguments[0][n]=arguments[r][n]);return arguments[0]};(r=s({content:[],startScreen:{startScreenTitle:"",startScreenSubtitle:""},endScreens:[{endScreenTitle:"",endScreenSubtitle:"",contentId:-1}],scoringOptionGroup:{scoringOption:"no-score"},l10n:{},behaviour:"individual"},r.branchingScenario)).l10n=s({startScreenButtonText:"Start the course",endScreenButtonText:"Restart the course",proceedButtonText:"Proceed",scoreText:"Your score:",backButtonText:"Back",fullscreenAria:"Fullscreen",replayButtonText:"Replay the video",disableProceedButtonText:"Require to complete the current module"},r.l10n),r.content.forEach((function(e,t){e.contentId=t,void 0===e.nextContentId&&(e.nextContentId=-1),r.behaviour.randomizeBranchingQuestions&&-1!==e.type.library.indexOf("H5P.BranchingQuestion")&&(e.type.params.branchingQuestion.randomize=!0)})),a.backwardsAllowedFlags=r.content.map((function(e){return"useBehavioural"===e.contentBehaviour?r.behaviour.enableBackwardsNavigation:"enabled"===e.contentBehaviour})),a.params=r,a.scoring=new H5P.BranchingScenario.Scoring(r,i.previousState),i&&i.previousState&&(a.previousState=i.previousState,i.previousState.hasOwnProperty("progress")&&(a.currentId=i.previousState.progress)),H5P.externalDispatcher.on("xAPI",(function(e){"answered"===e.getVerb()&&(a.scoring.isNoScoring()||a.scoring.isStaticScoring()&&!e.shouldLogStaticScore||a.scoring.isDynamicScoring()&&!e.shouldLogStaticScore&&!r.scoringOptionGroup.includeInteractionsScores)&&(e.ignoreStatement=!0)}));var o=function(e){var t=new H5P.BranchingScenario.GenericScreen(a,{isStartScreen:!1,titleText:e.endScreenTitle,subtitleText:e.endScreenSubtitle,image:e.endScreenImage,buttonText:r.l10n.endScreenButtonText,fullscreenAria:r.l10n.fullscreenAria,isCurrentScreen:!1,scoreText:r.l10n.scoreText,score:a.scoring.getScore(e.endScreenScore),maxScore:a.scoring.getMaxScore(),showScore:a.scoring.shouldShowScore(),endScreenText:e.endScreenText});return t.on("toggleFullScreen",(function(){a.toggleFullScreen()})),t};a.getLibrary=function(e){return void 0!==r.content[e]&&r.content[e]},a.on("exitFullScreen",(function(){setTimeout((function(){a.trigger("resize")}),100)})),a.on("started",(function(){var e=this.params.content[0];!1===a.canEnableBackButton(0)?a.disableBackButton():a.enableBackButton(),e&&e.type&&e.type.library&&"H5P.BranchingQuestion"===e.type.library.split(" ")[0]?a.trigger("navigated",{nextContentId:0}):(a.startScreen.hide(),a.libraryScreen.show(),a.triggerXAPI("progressed"),a.userPath.push(0)),a.currentId=0})),a.on("navigateNode",(function(e){var t=e.data.id,r=this.params.content[t];!1===a.canEnableBackButton(t)?a.disableBackButton():a.enableBackButton(),r&&r.type&&r.type.library&&"H5P.BranchingQuestion"===r.type.library.split(" ")[0]?a.trigger("navigated",{nextContentId:t}):(a.startScreen.hide(),a.libraryScreen.show(),a.triggerXAPI("progressed"),a.userPath.push(t)),a.currentId=t})),a.on("navigated",(function(e){e.data.reverse&&(a.libraryScreen&&a.libraryScreen.wrapper&&(a.libraryScreen.wrapper.style.height=""),a.userPath.pop(),e.data.nextContentId=a.userPath.pop()||0);var t=parseInt(e.data.nextContentId);a.userPath.push(t),a.currentId>-1&&H5P.BranchingScenario.LibraryScreen.isBranching(a.getLibrary(a.currentId))&&a.$container.find('.h5p-back-button[isBQ="true"]').length&&a.$container.find('.h5p-back-button[isBQ="true"]').remove();var n=a.getLibrary(t),i=!0;if(a.libraryScreen){if(a.libraryScreen.stopPlayback(a.currentId),!this.params.preventXAPI){var s=a.libraryScreen.getXAPIData(a.currentId),c=H5P.BranchingScenario.LibraryScreen.isBranching(a.getLibrary(a.currentId)),d=c&&s.statement&&s.statement.result&&void 0!==s.statement.result.response;!s||c&&!d||a.xAPIDataCollector.push(s)}}else a.libraryScreen=new H5P.BranchingScenario.LibraryScreen(a,r.startScreen.startScreenTitle,n),a.libraryScreen.on("toggleFullScreen",(function(){a.toggleFullScreen()})),a.$container.append(a.libraryScreen.getElement()),a.currentId=t;if(a.currentEndScreen&&a.currentEndScreen.isShowing?n?H5P.BranchingScenario.LibraryScreen.isBranching(n)||(a.currentEndScreen.hide(),a.currentEndScreen=null,a.libraryScreen.show()):(a.libraryScreen.hideFeedbackDialogs(),a.currentEndScreen.hide(),a.currentEndScreen=null):a.startScreen&&a.startScreen.isShowing&&n?H5P.BranchingScenario.LibraryScreen.isBranching(n)||(a.startScreen.hide(),a.libraryScreen.show(),i=!1):a.libraryScreen.hideFeedbackDialogs(),i&&a.trigger("resize"),-1!==a.currentId){a.triggerXAPI("progressed");var l={};a.libraryScreen.currentLibraryInstance&&a.libraryScreen.currentLibraryInstance.getScore&&(l={score:a.libraryScreen.currentLibraryInstance.getScore(),maxScore:a.libraryScreen.currentLibraryInstance.getMaxScore()}),a.scoring.addLibraryScore(this.currentId,this.libraryScreen.currentLibraryId,e.data.chosenAlternative,l)}if(!1===n){if(a.currentEndScreen=a.endScreens[t],e.data.feedback){var u=o({endScreenTitle:e.data.feedback.title||"",endScreenSubtitle:e.data.feedback.subtitle||"",endScreenImage:e.data.feedback.image,endScreenScore:e.data.feedback.endScreenScore,endScreenText:e.data.text});a.$container.append(u.getElement()),a.currentEndScreen=u}else a.scoring.isDynamicScoring()&&(a.currentEndScreen.setScore(a.getScore()),a.currentEndScreen.setMaxScore(a.getMaxScore()));a.startScreen.hide(),a.libraryScreen.hide(!0),a.currentEndScreen.show(),a.currentEndScreen.showSummaryButton(),a.scoring.isNoScoring()?a.triggerXAPICompleted(void 0,void 0):a.triggerXAPICompleted(a.scoring.getScore(a.currentEndScreen.getScore()),a.scoring.getMaxScore())}else a.libraryScreen.showNextLibrary(n,e.data.reverse),!1===a.canEnableBackButton(t)?a.disableBackButton():a.enableBackButton(),a.currentId=t;if(0!==e.data.nextContentId&&document.querySelector(".h5p-start-screen").classList.contains("h5p-current-screen")){var h=a.libraryScreen.wrapper.querySelector(".h5p-slide-in");h&&(h.classList.remove("h5p-next"),a.startScreen.hide(),a.libraryScreen.show())}})),a.on("restarted",(function(){a.currentEndScreen&&(a.currentEndScreen.hide(),a.currentEndScreen=null),a.scoring.restart(),a.xAPIDataCollector=[],a.startScreen.screenWrapper.style.height="",a.startScreen.screenWrapper.classList.remove("h5p-slide-out"),a.startScreen.show(a.isReverseTransition),a.isReverseTransition=!1,a.currentId=-1,a.userPath=[],a.libraryScreen&&a.libraryScreen.remove(),a.libraryScreen=new H5P.BranchingScenario.LibraryScreen(a,r.startScreen.startScreenTitle,a.getLibrary(0)),a.libraryScreen.on("toggleFullScreen",(function(){a.toggleFullScreen()})),a.$container.append(a.libraryScreen.getElement())})),a.on("resize",(function(e){if(!a.bubblingUpwards){a.changeLayoutToFitWidth(),a.libraryScreen&&"object"===t(a.libraryScreen)&&0!==Object.keys(a.libraryScreen).length&&a.libraryScreen.resize(e);var r=a.$container[0].getBoundingClientRect();r.width<=480?a.$container.addClass("h5p-phone-size"):a.$container.removeClass("h5p-phone-size"),r.width<768?a.$container.addClass("h5p-medium-tablet-size"):a.$container.removeClass("h5p-medium-tablet-size")}})),a.toggleFullScreen=function(){a.isFullScreen()?H5P.exitFullScreen&&H5P.exitFullScreen():H5P.fullScreen(a.$container,this)},a.isFullScreen=function(){return H5P.isFullscreen||a.$container&&a.$container[0].classList.contains("h5p-fullscreen")||a.$container&&a.$container[0].classList.contains("h5p-semi-fullscreen")},a.disableNavButton=function(){a.libraryScreen.navButton&&(a.libraryScreen.navButton.classList.add("h5p-disabled"),a.libraryScreen.navButton.setAttribute("disabled",!0),a.libraryScreen.navButton.setAttribute("title",r.l10n.disableProceedButtonText))},a.enableNavButton=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a.libraryScreen.navButton&&(a.libraryScreen.navButton.classList.remove("h5p-disabled"),a.libraryScreen.navButton.removeAttribute("disabled"),a.libraryScreen.navButton.removeAttribute("title"),e&&a.animateNavButton())},a.hideNavButton=function(){a.libraryScreen.navButton&&a.libraryScreen.navButton.classList.add("h5p-hidden")},a.showNavButton=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a.libraryScreen.navButton){a.libraryScreen.navButton.classList.remove("h5p-hidden"),document.activeElement.blur();var t=100;e&&a.animateNavButton(),setTimeout((function(){a.libraryScreen.navButton.focus()}),t)}},a.animateNavButton=function(){a.libraryScreen.navButton.classList.contains("h5p-animate")||a.libraryScreen.navButton.classList.add("h5p-animate")},a.unanimateNavButton=function(){a.libraryScreen.navButton.classList.remove("h5p-animate")},a.getScore=function(){return a.scoring.getScore()},a.getMaxScore=function(){return a.scoring.getMaxScore()},a.changeLayoutToFitWidth=function(){var e=parseInt(window.getComputedStyle(document.getElementsByTagName("body")[0]).fontSize,10);this.$container.width()/e>43?a.$container[0].classList.add("h5p-wide-screen"):a.$container[0].classList.add("h5p-mobile-screen")},a.disableBackButton=function(){a.libraryScreen&&a.libraryScreen.backButton&&(a.libraryScreen.backButton.classList.add("h5p-disabled"),a.libraryScreen.backButton.setAttribute("disabled",!0))},a.enableBackButton=function(){a.libraryScreen&&a.libraryScreen.backButton&&(a.libraryScreen.backButton.classList.remove("h5p-disabled"),a.libraryScreen.backButton.removeAttribute("disabled"))},a.getUserPath=function(){return a.userPath},a.canEnableBackButton=function(e){return"number"==typeof e&&!(e<0||e>a.backwardsAllowedFlags.length-1)&&a.backwardsAllowedFlags[e]},a.attach=function(t){if(void 0!==this.isRoot&&this.isRoot()&&this.setActivityStarted(),a.$container=t,t.addClass("h5p-branching-scenario").html(""),!r.content||0===r.content.length){var n=document.createElement("div");return n.innerHTML="No content",void a.$container.append(n)}var i,s,c,d,l,u;if(a.startScreen=(!0,s=(i=r.startScreen).startScreenTitle,c=i.startScreenSubtitle,d=i.startScreenImage,l=i.startScreenAltText,(u=new H5P.BranchingScenario.GenericScreen(a,{isStartScreen:!0,titleText:s,subtitleText:c,image:d,altText:l,fullscreenAria:r.l10n.fullscreenAria,buttonText:r.l10n.startScreenButtonText,isCurrentScreen:true})).on("toggleFullScreen",(function(){a.toggleFullScreen()})),u),a.$container.append(a.startScreen.getElement()),-1===a.currentId)a.libraryScreen=new H5P.BranchingScenario.LibraryScreen(a,r.startScreen.startScreenTitle,a.getLibrary(0));else{var h,p=function(t,r){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw s}}}}(a.scoring.scores);try{for(p.s();!(h=p.n()).done;){var b=h.value;a.currentId!==b.id&&new H5P.BranchingScenario.LibraryScreen(a,r.startScreen.startScreenTitle,a.getLibrary(b.id))}}catch(e){p.e(e)}finally{p.f()}a.libraryScreen=new H5P.BranchingScenario.LibraryScreen(a,r.startScreen.startScreenTitle,a.getLibrary(a.currentId)),a.trigger("navigateNode",{id:a.currentId})}a.libraryScreen.on("toggleFullScreen",(function(){a.toggleFullScreen()})),a.$container.append(a.libraryScreen.getElement()),r.endScreens.forEach((function(e){a.endScreens[e.contentId]=o(e),a.$container.append(a.endScreens[e.contentId].getElement())}))},a.getXAPIData=function(){if(a.currentEndScreen){var e=a.createXAPIEventTemplate("answered"),t=e.getVerifiedStatementValue(["object","definition"]);H5P.jQuery.extend(t,{interactionType:"compound",type:"http://adlnet.gov/expapi/activities/cmi.interaction"}),t.extensions={"https://h5p.org/x-api/no-question-score":1};var r=a.scoring.getScore(a.currentEndScreen.getScore()),n=a.scoring.getMaxScore();return e.setScoredResult(r,n,this,!0,r===n),{statement:e.data.statement,children:a.xAPIDataCollector}}console.error("Called getXAPIData before finished.")},a.getCurrentState=function(){var e={answers:[],progress:a.currentId,scores:[]};return a.instances.forEach((function(t){if(t.getCurrentState instanceof Function||"function"==typeof t.getCurrentState){var r=a.params.content.filter((function(e){return e.type.subContentId===t.subContentId}))[0];e.answers[r.contentId]=t.getCurrentState()}})),e.scores=a.scoring.scores,e}},H5P.BranchingScenario.prototype=Object.create(H5P.EventDispatcher.prototype),H5P.BranchingScenario.prototype.constructor=H5P.BranchingScenario},418:(e,t,r)=>{"use strict";var n=r(20);H5P.BranchingScenario.GenericScreen=function(){function e(e,t){var r=this;H5P.EventDispatcher.call(this);var n=this;n.screenData=t,n.parent=e,n.isShowing=t.isStartScreen,n.isFeedbackAvailable=!1,n.screenWrapper=document.createElement("div"),n.screenWrapper.classList.add(t.isStartScreen?"h5p-start-screen":"h5p-end-screen"),n.screenWrapper.classList.add(t.isCurrentScreen?"h5p-current-screen":"h5p-next-screen"),t.isCurrentScreen?n.parent.currentHeight="45em":this.screenWrapper.classList.add("h5p-branching-hidden");var i=document.createElement("div");i.classList.add("h5p-branching-scenario-screen-content"),n.contentDiv=i;var a=document.createElement("div");a.classList.add("h5p-feedback-content-content"),i.appendChild(a),n.feedbackText=a;var s=document.createElement("h1");s.className="h5p-branching-scenario-title-text",s.innerHTML=t.titleText;var o=document.createElement("div");o.className="h5p-branching-scenario-subtitle-text",o.innerHTML=t.subtitleText;var c=document.createElement("button");c.classList.add(t.isStartScreen?"h5p-start-button":"h5p-end-button"),c.classList.add("transition"),c.onclick=function(){t.isStartScreen?n.parent.trigger("started"):n.parent.trigger("restarted");var e=document.getElementsByClassName("h5p-start-screen")[0];t.isStartScreen||(e.style.height=""),n.parent.navigating=!0},n.navButton=c;var d=document.createTextNode(t.buttonText);if(c.appendChild(d),a.appendChild(s),a.appendChild(o),i.appendChild(c),t.showScore&&void 0!==t.score&&(n.scoreWrapper=this.createResultContainer(t.scoreText,t.score,t.maxScore),i.insertBefore(n.scoreWrapper,i.firstChild)),H5P.canHasFullScreen){var l=document.createElement("button");l.className="h5p-branching-full-screen",l.setAttribute("aria-label",this.parent.params.l10n.fullscreenAria),l.addEventListener("click",(function(){r.trigger("toggleFullScreen")})),n.screenWrapper.appendChild(l)}n.screenWrapper.appendChild(n.createScreenBackground(t.isStartScreen,t.image,t.altText)),n.screenWrapper.appendChild(i),(t.showScore&&void 0!==t.score||""!==t.titleText||""!==t.subtitleText)&&(a.tabIndex=-1,n.isFeedbackAvailable=!0),n.getScore=function(){return t.score},n.getMaxScore=function(){return t.maxScore},n.checkIntroReset=function(){var e=document.getElementsByClassName("h5p-start-screen")[0];["h5p-end-screen","h5p-current-screen"].every((function(e){return n.screenWrapper.classList.contains(e)}))?e.classList.add("h5p-reset-start"):e.classList.contains("h5p-reset-start")&&e.classList.remove("h5p-reset-start")}}return e.prototype.getElement=function(){return this.screenWrapper},e.prototype.setScore=function(e){this.scoreValue&&void 0!==e&&(this.scoreValue.textContent=e.toString())},e.prototype.setMaxScore=function(e){void 0!==e&&(this.maxScoreValue.textContent=e.toString())},e.prototype.createResultContainer=function(e,t,r){var n=document.createElement("div");n.classList.add("h5p-result-wrapper");var i=document.createElement("div");i.classList.add("h5p-result-container");var a=document.createElement("div");a.classList.add("h5p-score-text"),a.appendChild(document.createTextNode(e));var s=document.createElement("div");s.classList.add("h5p-score-circle");var o=document.createElement("span");o.className="h5p-score-value",this.scoreValue=document.createTextNode(t.toString()),o.appendChild(this.scoreValue),s.appendChild(o);var c=document.createElement("span");c.className="h5p-score-delimiter",c.textContent="/",s.appendChild(c);var d=document.createElement("span");return d.className="h5p-max-score",this.maxScoreValue=document.createTextNode(r.toString()),d.appendChild(this.maxScoreValue),s.appendChild(d),i.appendChild(a),i.appendChild(s),n.appendChild(i),n.style.display="none",n},e.prototype.createScreenBackground=function(e,t,r){var n=this,i=document.createElement("div");i.classList.add("h5p-screen-background");var a=document.createElement("div");a.classList.add("h5p-screen-banner");var s=document.createElement("img");return s.classList.add("h5p-background-image"),t&&t.path?(s.tabIndex=0,s.src=H5P.getPath(t.path,this.parent.contentId)):s.src=e?this.parent.getLibraryFilePath("assets/start-screen-default.jpg"):this.parent.getLibraryFilePath("assets/end-screen-default.jpg"),r&&r.length&&s.setAttribute("aria-label",r),s.addEventListener("load",(function(){n.parent.trigger("resize")})),i.appendChild(a),i.appendChild(s),i},e.prototype.show=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.isShowing=!0,e&&t.screenWrapper.classList.add("h5p-previous"),t.screenWrapper.classList.add("h5p-slide-in"),t.screenWrapper.classList.remove("h5p-branching-hidden"),t.screenWrapper.addEventListener("animationend",(function(r){"slide-in"===r.animationName&&(e&&t.screenWrapper.classList.remove("h5p-previous"),t.screenWrapper.classList.remove("h5p-next-screen"),t.screenWrapper.classList.remove("h5p-slide-in"),t.screenWrapper.classList.add("h5p-current-screen"),t.parent.trigger("resize"),t.isFeedbackAvailable?t.feedbackText.focus():t.navButton.focus(),t.checkIntroReset())}))},e.prototype.hide=function(){var e=this;e.isShowing=!1,e.screenWrapper.classList.add("h5p-slide-out"),e.screenWrapper.addEventListener("animationend",(function(t){"slide-out"===t.animationName&&(e.screenWrapper.classList.add("h5p-branching-hidden"),e.screenWrapper.classList.remove("h5p-current-screen"),e.screenWrapper.classList.add("h5p-next-screen"),e.screenWrapper.classList.remove("h5p-slide-out"))}))},e.prototype.showSummaryButton=function(){var e=this;(0,n.A)(e,e.screenData,e.contentDiv)},e}()},186:(e,t,r)=>{"use strict";var n=r(734);H5P.BranchingScenario.LibraryScreen=function(){function e(e,t,r){var n=this;H5P.EventDispatcher.call(this),this.parent=e,this.currentLibraryElement,this.currentLibraryInstance,this.currentLibraryId=0,this.nextLibraryId=r.nextContentId,this.libraryFeedback=r.feedback,this.nextLibraries={},this.libraryInstances={},this.libraryFinishingRequirements=[],this.libraryTitle,this.branchingQuestions=[],this.navButton,this.header,this.isShowing=!1,this.contentOverlays=[];var i=r.type&&r.type.metadata&&r.type.metadata.title?r.type.metadata.title:"";this.wrapper=this.createWrapper(t,i||"Untitled Content",r.showContentTitle&&i),this.wrapper.classList.add("h5p-next-screen"),this.wrapper.classList.add("h5p-branching-hidden");var a=this.createLibraryElement(r,!1);this.currentLibraryWrapper=a,this.currentLibraryElement=a.getElementsByClassName("h5p-branching-scenario-content")[0],this.currentLibraryInstance=this.libraryInstances[0],this.createNextLibraries(r),this.wrapper.appendChild(a),this.toggleIVTabIndexes=function(e){var t=this.currentLibraryInstance.$container[0].querySelectorAll("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]");if(t)for(var r=0;r<t.length;r++)if("-1"===e){var n=t[r].getAttribute("tabindex");t[r].dataset.tabindex=n,t[r].setAttribute("tabindex",e)}else{var i=t[r].dataset.tabindex;t[r].classList.contains("ui-slider-handle")?(t[r].setAttribute("tabindex",0),t[r].dataset.tabindex=""):void 0!==i?(t[r].setAttribute("tabindex",e),t[r].dataset.tabindex=""):t[r].setAttribute("tabindex",e)}},e.on("enterFullScreen",(function(){setTimeout((function(){n.currentLibraryInstance&&n.currentLibraryInstance.trigger("resize")}),500)}))}return e.prototype.handleLibraryResize=function(){if(this.parent.isFullScreen())return this.currentLibraryWrapper.style.height="",void(this.wrapper.style.minHeight="");this.currentLibraryWrapper.style.height=this.currentLibraryElement.clientHeight+40+"px",this.wrapper.style.minHeight=this.currentLibraryElement.clientHeight+40+70.17+"px",this.currentLibraryWrapper.offsetHeight<this.currentLibraryElement.scrollHeight&&(this.currentLibraryElement.tabIndex=0)},e.prototype.createWrapper=function(e,t,r){var i=this,a=this,s=this.parent,o=document.createElement("div"),c=document.createElement("div");if(c.classList.add("h5p-title-wrapper"),H5P.canHasFullScreen){var d=document.createElement("button");d.className="h5p-branching-full-screen",d.setAttribute("aria-label",this.parent.params.l10n.fullscreenAria),d.addEventListener("click",(function(){i.trigger("toggleFullScreen")})),c.appendChild(d)}var l=document.createElement("div");l.className="h5p-branching-header";var u=document.createElement("h1");u.innerHTML=e,l.appendChild(u);var h=document.createElement("h2");h.classList.add("library-subtitle"),h.innerHTML=r?t:"&nbsp;",h.setAttribute("tabindex","-1"),h.setAttribute("aria-label",t),l.appendChild(h),c.appendChild(l),this.libraryTitle=h;var p=document.createElement("div");p.classList.add("h5p-nav-button-wrapper"),-1!==s.backwardsAllowedFlags.indexOf(!0)&&(this.backButton=this.createBackButton(s.params.l10n.backButtonText),p.appendChild(this.backButton));var b=document.createElement("button");b.classList.add("transition"),b.onclick=function(){if(!1===s.navigating){var e=a.libraryFeedback.title&&a.libraryFeedback.title.trim(),t=a.libraryFeedback.subtitle&&a.libraryFeedback.subtitle.trim(),r=!!(e||t||a.libraryFeedback.image);if(r&&-1!==a.nextLibraryId){void 0===a.overlay&&(a.overlay=document.createElement("div"),a.overlay.className="h5p-branching-scenario-overlay",a.wrapper.appendChild(a.overlay),a.hideBackgroundFromReadspeaker());var n=document.createElement("div");n.classList.add("h5p-branching-question-wrapper"),n.classList.add("h5p-branching-scenario-feedback-dialog");var i=document.createElement("div");i.classList.add("h5p-branching-question-container"),n.appendChild(i);var o=a.createFeedbackScreen(a.libraryFeedback,a.nextLibraryId);i.appendChild(o),i.classList.add("h5p-start-outside"),i.classList.add("h5p-fly-in"),a.currentLibraryWrapper.style.zIndex=0,a.wrapper.appendChild(n),o.focus()}else{var c={nextContentId:a.nextLibraryId};(r||void 0!==a.libraryFeedback.endScreenScore)&&(c.feedback=a.libraryFeedback),s.trigger("navigated",c)}s.navigating=!0}},b.classList.add("h5p-nav-button"),this.navButton=document.createElement("button"),this.navButton.classList.add("transition"),this.navButton.addEventListener("animationend",(function(){i.parent.unanimateNavButton()})),this.navButton.addEventListener("click",(function(){if(!i.parent.proceedButtonInProgress){i.parent.proceedButtonInProgress=!0;var e=i;new Promise((function(t){e.handleProceed()&&t(!0)})).then((function(){e.parent.proceedButtonInProgress=!1}))}})),this.navButton.classList.add("h5p-nav-button"),this.navButton.appendChild(document.createTextNode(s.params.l10n.proceedButtonText)),p.appendChild(this.navButton);var y=document.createElement("div");return y.classList.add("h5p-screen-header"),this.header=y,y.appendChild(c),y.appendChild(p),o.appendChild(y),(0,n.kp)(o,(function(){i.wrapper.clientHeight>500&&(i.wrapper.style.minHeight=i.wrapper.clientHeight+"px")})),o.addEventListener("animationend",(function(e){"slide-in"===e.animationName&&a.currentLibraryElement&&(s.trigger("resize"),setTimeout((function(){(0,n.kp)(a.currentLibraryElement,(function(){a.handleLibraryResize(),s.trigger("resize")}))}),100))})),o},e.prototype.createBackButton=function(e){var t=this,r=this,n=document.createElement("button");return n.classList.add("transition"),n.classList.add("h5p-back-button"),n.addEventListener("click",(function(e){if(e.currentTarget.hasAttribute("isBQ"))return t.overlay&&(null!==t.overlay.parentNode&&t.overlay.parentNode.removeChild(t.overlay),t.overlay=void 0,t.branchingQuestions.forEach((function(e){null!==e.parentNode&&e.parentNode.removeChild(e)})),t.showBackgroundToReadspeaker()),"H5P.BranchingQuestion"===r.parent.params.content[0].type.library.split(" ")[0]&&0===r.parent.currentId?(r.parent.trigger("restarted"),n):void r.parent.trigger("navigated",{reverse:!0});if(!0!==r.parent.navigating){if(0===r.currentLibraryId&&"H5P.BranchingQuestion"!==r.parent.params.content[r.parent.currentId].type.library.split(" ")[0])return r.parent.isReverseTransition=!0,r.parent.trigger("restarted"),n;r.parent.trigger("navigated",{reverse:!0}),r.parent.navigating=!0}})),n.appendChild(document.createTextNode(e)),n},e.prototype.handleProceed=function(){var e=this,t=!0;if(!1===this.parent.navigating){var r=this.libraryFeedback.title&&this.libraryFeedback.title.trim(),n=this.libraryFeedback.subtitle&&this.libraryFeedback.subtitle.trim(),i=!!(r||n||this.libraryFeedback.image);if(i&&-1!==this.nextLibraryId){void 0===this.overlay&&(this.overlay=document.createElement("div"),this.overlay.className="h5p-branching-scenario-overlay",this.wrapper.appendChild(this.overlay),this.hideBackgroundFromReadspeaker());var a=document.createElement("div");a.classList.add("h5p-branching-question-wrapper"),a.classList.add("h5p-branching-scenario-feedback-dialog");var s=document.createElement("div");s.classList.add("h5p-branching-question-container"),a.appendChild(s);var o=this.createFeedbackScreen(this.libraryFeedback,this.nextLibraryId);s.appendChild(o),s.classList.add("h5p-start-outside"),s.classList.add("h5p-fly-in"),this.currentLibraryWrapper.style.zIndex=0,setTimeout((function(){e.wrapper.appendChild(a),parseInt(e.currentLibraryWrapper.style.height)<s.offsetHeight&&(e.currentLibraryElement.style.height=s.offsetHeight+"px",e.wrapper.style.height=s.offsetHeight+"px")}),100),o.focus(),this.parent.navigating=!0}else{var c={nextContentId:this.nextLibraryId};(i||void 0!==this.libraryFeedback.endScreenScore)&&(c.feedback=this.libraryFeedback);var d=this;t=!1,new Promise((function(e){e(d.parent.trigger("navigated",c))})).then((function(){e.parent.proceedButtonInProgress=!1,e.parent.navigating=!0}))}}if(t)return t},e.prototype.createFeedbackScreen=function(t,r){var n=this,i="h5p-branching-feedback-title-"+e.idCounter++,a=document.createElement("div");if(a.classList.add("h5p-branching-question"),a.classList.add(void 0!==t.image?"h5p-feedback-has-image":"h5p-feedback-default"),a.setAttribute("role","dialog"),a.setAttribute("tabindex","-1"),a.setAttribute("aria-labelledby",i),void 0!==t.image&&void 0!==t.image.path){var s=document.createElement("div");s.classList.add("h5p-branching-question"),s.classList.add("h5p-feedback-image");var o=document.createElement("img");o.src=H5P.getPath(t.image.path,n.parent.contentId),s.appendChild(o),a.appendChild(s)}var c=document.createElement("div");c.classList.add("h5p-branching-question"),c.classList.add("h5p-feedback-content");var d=document.createElement("div");d.classList.add("h5p-feedback-content-content"),c.appendChild(d);var l=document.createElement("h1");if(l.id=i,l.innerHTML=t.title||"",d.appendChild(l),t.subtitle){var u=document.createElement("div");u.innerHTML=t.subtitle||"",d.appendChild(u)}var h=document.createElement("button");h.onclick=function(){n.parent.trigger("navigated",{nextContentId:r})};var p=document.createTextNode(this.parent.params.l10n.proceedButtonText);return h.appendChild(p),c.appendChild(h),c.addEventListener("keydown",(function(e){("Tab"===e.key||9===e.keyCode)&&e.preventDefault()})),a.appendChild(c),a},e.prototype.createLibraryElement=function(e,t){var r=this,n=document.createElement("div");n.classList.add("h5p-library-wrapper");var i=document.createElement("div");i.classList.add("h5p-branching-scenario-content"),this.appendRunnable(i,e.type,e.contentId,e);var a=e.type&&e.type.library.split(" ")[0];return this.contentOverlays[e.contentId]=new H5P.BranchingScenario.LibraryScreenOverlay(this),n.appendChild(this.contentOverlays[e.contentId].getDOM()),"H5P.InteractiveVideo"!==a&&"H5P.Video"!==a||(this.contentOverlays[e.contentId].addButton("replay",this.parent.params.l10n.replayButtonText,(function(){r.handleReplayVideo(a,e)})),this.contentOverlays[e.contentId].addButton("proceed",this.parent.params.l10n.proceedButtonText,(function(){r.handleProceedAfterVideo()}))),n.appendChild(i),t&&(n.classList.add("h5p-next"),i.classList.add("h5p-branching-hidden")),"H5P.BranchingQuestion"===a&&i.classList.add("h5p-branching-hidden"),n},e.prototype.handleReplayVideo=function(e,t){this.contentOverlays[this.currentLibraryId].hide(),!0===this.libraryFinishingRequirements[t.contentId]&&this.hasValidVideo(t)&&this.parent.disableNavButton(),this.currentLibraryInstance.currentState=3,this.currentLibraryInstance.seek(0),this.currentLibraryInstance.play(),"H5P.InteractiveVideo"===e&&this.resetIVProgress()},e.prototype.resetIVProgress=function(){this.currentLibraryInstance.interactions.forEach((function(e){e.resetTask()}));var e=this.currentLibraryInstance;e.addSliderInteractions(),e.endscreen&&(e.endscreen.update(),e.endscreen.$closeButton[0].click(),this.wrapper.getElementsByClassName("h5p-star-foreground")[0].classList.remove("h5p-star-active"))},e.prototype.handleProceedAfterVideo=function(){this.contentOverlays[this.currentLibraryId].hide(),this.handleProceed()},e.prototype.appendRunnable=function(e,t,r,n){var i=this,a=this.parent,s=t.library.split(" ")[0];"H5P.Video"===s&&(t.params.visuals.fit=!1),"H5P.BranchingQuestion"===s&&(t.params.proceedButtonText=a.params.l10n.proceedButtonText);var o=H5P.jQuery.extend(!0,{},t);this.currentMachineName=o.library.split(" ",2)[0];var c=H5P.newRunnable(o,this.parent.contentId,H5P.jQuery(e),!0,{parent:this.parent,previousState:this.parent.previousState&&this.parent.previousState.answers&&this.parent.previousState.answers[n.contentId]?this.parent.previousState.answers[n.contentId]:void 0});if(("enabled"===this.parent.params.content[r].forceContentFinished||"useBehavioural"===this.parent.params.content[r].forceContentFinished&&!0===this.parent.params.behaviour.forceContentFinished)&&(this.libraryFinishingRequirements[r]=this.forceContentFinished(c,t.library.split(" ")[0]),this.addFinishedListeners(c,t.library.split(" ")[0])),c.setActivityStarted(),0===t.library.indexOf("H5P.Video ")&&this.nextIsBranching(r)&&c.on("stateChange",(function(e){e.data===H5P.Video.ENDED&&i.navButton&&i.handleProceed()})),0===t.library.indexOf("H5P.Image")&&c.on("loaded",(function(){i.handleLibraryResize(),i.parent.trigger("resize")})),0===t.library.indexOf("H5P.Video")||0===t.library.indexOf("H5P.InteractiveVideo")){var d=0===t.library.indexOf("H5P.Video")?c:c.video;d.on("loaded",(function(){i.handleLibraryResize()})),d.on("error",(function(){i.parent.enableNavButton()}))}c.on("navigated",(function(e){a.trigger("navigated",e.data)})),this.libraryInstances[r]=c,this.bubbleUp(c,"resize",a),this.disableFullscreen(c),c.metadata=t.metadata,-1===this.parent.instances.map((function(e){return e.subContentId})).indexOf(c.subContentId)&&this.parent.instances.push(c)},e.prototype.stopPlayback=function(e){var t=this.libraryInstances[e];if(t)try{if(void 0!==t.pause&&(t.pause instanceof Function||"function"==typeof t.pause))t.pause();else if(void 0!==t.video&&void 0!==t.video.pause&&(t.video.pause instanceof Function||"function"==typeof t.video.pause))t.video.pause();else if(void 0!==t.stop&&(t.stop instanceof Function||"function"==typeof t.stop))t.stop();else if(void 0!==t.pauseMedia&&(t.pauseMedia instanceof Function||"function"==typeof t.pauseMedia)&&t.elementInstances[t.currentSlideIndex])for(var r=0;r<t.elementInstances[t.currentSlideIndex].length;r++)t.pauseMedia(t.elementInstances[t.currentSlideIndex][r])}catch(e){H5P.error(e)}},e.prototype.forceContentFinished=function(e,t){var r=!1;return e&&(r=r||e.getScore&&"function"==typeof e.getScore),t&&(r=r||"H5P.Audio"===t||"H5P.Video"===t),("H5P.CoursePresentation"===t&&e&&e.children.length+(e.isTask?1:0)===1||!0===e.activeSurface)&&(r=!1),r},e.prototype.addFinishedListeners=function(e,t){var r=this,n=this;if("string"==typeof t&&e)switch(t){case"H5P.CoursePresentation":e.on("xAPI",(function(t){"progressed"===t.data.statement.verb.display["en-US"]&&parseInt(t.data.statement.object.definition.extensions["http://id.tincanapi.com/extension/ending-point"])===e.children.length+(e.isTask?1:0)&&r.navButton.classList.contains("h5p-disabled")&&n.parent.enableNavButton(!0)}));break;case"H5P.InteractiveVideo":e.on("xAPI",(function(e){"completed"===e.data.statement.verb.display["en-US"]&&n.handleVideoOver()})),e.video.on("stateChange",(function(t){if(t.data===H5P.Video.ENDED||t.data===H5P.Video.PLAYING&&!1===n.contentOverlays[n.currentLibraryId].hidden){var r=e.interactions.filter((function(e){return void 0!==e.getProgress()}));e.hasStar&&r.length>0?n.parent.enableNavButton():n.handleVideoOver(),this.pause()}}));break;case"H5P.Video":e.on("stateChange",(function(e){e.data===H5P.Video.ENDED&&(n.nextIsBranching(n.currentLibraryId)||n.handleVideoOver())}));break;case"H5P.Audio":e.audio.on("ended",(function(){n.parent.enableNavButton()}));break;default:"function"==typeof e.getAnswerGiven&&e.on("xAPI",(function(e){"answered"!==e.data.statement.verb.display["en-US"]&&"completed"!==e.data.statement.verb.display["en-US"]||n.parent.enableNavButton()}))}},e.prototype.handleVideoOver=function(){this.nextIsBranching(this.currentLibraryId)?this.handleProceed():this.showContentOverlay(),this.parent.enableNavButton()},e.prototype.showContentOverlay=function(){this.contentOverlays[this.currentLibraryId].show()},e.prototype.hideContentOverlay=function(){this.contentOverlays[this.currentLibraryId].hide()},e.prototype.getXAPIData=function(e){if(this.libraryInstances[e]&&this.libraryInstances[e].getXAPIData)return this.libraryInstances[e].getXAPIData()},e.prototype.nextIsBranching=function(t){var r=void 0!==t?this.parent.params.content[t].nextContentId:void 0;return void 0!==r&&r>0&&e.isBranching(this.parent.params.content[r])},e.prototype.createNextLibraries=function(e){this.removeNextLibraries(),this.nextLibraries={},this.loadLibrary(e)},e.prototype.createNextLibrary=function(e){this.removeNextLibraries(),this.nextLibraries={},this.loadLibrary(e,e.contentId)},e.prototype.loadLibrary=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==r?r:e.nextContentId;if("H5P.BranchingQuestion"!==e.type.library.split(" ")[0]){var i=this.parent.getLibrary(n);if(!1===i)return;i.type&&"H5P.BranchingQuestion"!==i.type.library.split(" ")[0]&&(this.nextLibraries[n]=this.createLibraryElement(i,!0),this.wrapper.appendChild(this.nextLibraries[n]))}else{var a=e.type.params.branchingQuestion.alternatives||[],s=a.map((function(e){return e.nextContentId}));s.forEach((function(e){var r=t.parent.getLibrary(e);!1!==r&&r.type&&"H5P.BranchingQuestion"!==r.type.library.split(" ")[0]&&(t.nextLibraries[e]=t.createLibraryElement(r,!0),t.wrapper.appendChild(t.nextLibraries[e]))}))}},e.prototype.removeNextLibraries=function(){for(var e=this.wrapper.getElementsByClassName("h5p-next"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])},e.prototype.disableFullscreen=function(e){switch(e.libraryInfo.machineName){case"H5P.CoursePresentation":e.$fullScreenButton&&e.$fullScreenButton.remove();break;case"H5P.InteractiveVideo":e.on("controls",(function(){e.controls.$fullscreen&&e.controls.$fullscreen.remove()}))}},e.prototype.bubbleUp=function(e,t,r){e.on(t,(function(e){r.bubblingUpwards=!0,r.trigger(t,e),r.bubblingUpwards=!1}))},e.prototype.hasValidVideo=function(e){var t=e.type,r=t.metadata.contentType,n="Interactive Video"===r?t.params.interactiveVideo.video.files:t.params.sources;return!(!t||"Interactive Video"!==r&&"Video"!==r||!n||!n[0].mime||"video/unknown"===n[0].mime||!("video/webm"!==n[0].mime&&"video/mp4"!==n[0].mime||H5P.VideoHtml5.canPlay(n)))},e.prototype.show=function(){var e=this,t=e.parent.params.content[e.currentLibraryId];!0!==e.libraryFinishingRequirements[e.currentLibraryId]||!e.hasValidVideo(t)&&"H5P.CoursePresentation"!==t.type.library.split(" ")[0]||(e.contentOverlays[e.currentLibraryId].hide(),e.parent.disableNavButton()),e.isShowing=!0,e.wrapper.classList.add("h5p-slide-in"),e.wrapper.classList.remove("h5p-branching-hidden"),e.wrapper.addEventListener("animationend",(function(t){"h5p-next-screen h5p-slide-in"===t.target.className&&(e.wrapper.classList.remove("h5p-next-screen"),e.wrapper.classList.remove("h5p-slide-in"),e.wrapper.classList.add("h5p-current-screen"),e.parent.navigating=!1,e.wrapper.style.minHeight=e.parent.currentHeight,e.libraryTitle.focus())}))},e.prototype.hide=function(e){var t=this;t.isShowing=!1;for(var r=0;r<this.nextLibraries.length;r++)this.nextLibraries[r].style.display="none",null!==this.nextLibraries[r].parentNode&&this.nextLibraries[r].parentNode.removeChild(this.nextLibraries[r]);function n(){t.wrapper.classList.remove("h5p-current-screen"),t.wrapper.classList.add("h5p-next-screen"),t.wrapper.classList.remove("h5p-slide-out"),t.wrapper.classList.remove("h5p-slide-out-reverse"),t.wrapper.classList.remove("h5p-slide-pseudo"),setTimeout((function(){null!==t.wrapper.parentNode&&(t.wrapper.parentNode.removeChild(t.wrapper),t.remove(),t.parent.libraryScreen=null,t.parent.trigger("resize"))}),100)}this.overlay&&(null!==this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=void 0,this.branchingQuestions.forEach((function(e){null!==e.parentNode&&e.parentNode.removeChild(e)}))),t.wrapper.classList.add("h5p-slide-out"),e?setTimeout((function(){n()}),800):t.wrapper.addEventListener("animationend",n)},e.prototype.hideBranchingQuestion=function(e){this.nextLibraryId=e.nextContentId,this.libraryFeedback=e.feedback,null!==this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=void 0,this.branchingQuestions.forEach((function(e){null!==e.parentNode&&e.parentNode.removeChild(e)})),this.createNextLibraries(e),this.parent.navigating=!1,this.navButton.focus(),this.showBackgroundToReadspeaker()},e.prototype.hideFeedbackDialogs=function(){this.overlay&&(null!==this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=void 0,this.showBackgroundToReadspeaker());var e=document.querySelector(".h5p-current-screen");if(e){var t=e.querySelector(".h5p-branching-question-wrapper");t&&t.parentNode.removeChild(t)}},e.prototype.resizeScreen=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.questionContainer){var t=e?this.parent.startScreen.screenWrapper:this.wrapper,r=parseInt(window.getComputedStyle(this.questionContainer,null).getPropertyValue("padding-top"),10);t.style.height=this.questionContainer.offsetHeight+r+"px"}},e.prototype.showNextLibrary=function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.nextLibraryId=t.nextContentId,this.libraryFeedback=t.feedback,e.isBranching(t)){!0===this.parent.params.behaviour&&this.parent.disableNavButton(),this.branchingQuestions.forEach((function(e){null!==e.parentNode&&e.parentNode.removeChild(e)}));var n=document.querySelector(".h5p-current-screen");void 0===this.overlay&&(this.overlay=document.createElement("div"),this.overlay.className="h5p-branching-scenario-overlay",n.appendChild(this.overlay),this.hideBackgroundFromReadspeaker());var i=document.createElement("div");i.classList.add("h5p-nav-button-wrapper"),-1!==this.parent.backwardsAllowedFlags.indexOf(!0)&&(this.bqBackButton=this.createBackButton(this.parent.params.l10n.backButtonText),this.bqBackButton.setAttribute("isBQ",!0),!1===this.parent.canEnableBackButton(t.contentId)&&(this.bqBackButton.classList.add("h5p-disabled"),this.bqBackButton.setAttribute("disabled",!0)),i.appendChild(this.bqBackButton));var a=document.createElement("div");a.className="h5p-branching-question-wrapper",this.appendRunnable(a,t.type,t.contentId,t),n.appendChild(a),this.branchingQuestions.push(a);var s="h5p-branching-question-title-"+e.idCounter++,o=a.querySelector(".h5p-branching-question-container");this.questionContainer=o,o.setAttribute("role","dialog"),o.setAttribute("tabindex","-1"),o.setAttribute("aria-labelledby",s),o.classList.add("h5p-start-outside"),o.classList.add("h5p-fly-in"),a.querySelector(".h5p-branching-question-title").id=s,document.querySelector(".h5p-branching-question").appendChild(i),this.currentLibraryWrapper.style.zIndex=0;var c=this.parent.isFullScreen(),d=this.parent.$container[0].classList.contains("h5p-mobile-screen");""!==this.currentLibraryWrapper.style.height||this.parent.startScreen.isShowing||c||d?this.parent.startScreen.isShowing&&!c?this.resizeScreen(!0):parseInt(this.currentLibraryWrapper.style.height)<o.offsetHeight&&(this.currentLibraryWrapper.style.height=o.offsetHeight+"px"):this.resizeScreen(),this.createNextLibraries(t),this.parent.navigating=!1,a.addEventListener("animationend",(function(){void 0!==a.querySelectorAll(".h5p-branching-question-alternative")[0]&&o.focus()}))}else{var l=!0;!0!==this.libraryFinishingRequirements[t.contentId]||!this.hasValidVideo(t)&&"H5P.CoursePresentation"!==t.type.library.split(" ")[0]||(this.contentOverlays[this.currentLibraryId].hide(),this.parent.disableNavButton(),l=!1);var u=t.type&&t.type.metadata&&t.type.metadata.title?t.type.metadata.title:"";this.libraryTitle.setAttribute("aria-label",u||"Untitled Content"),this.libraryTitle.innerHTML=t.showContentTitle&&u?u:"&nbsp;",this.currentLibraryId===t.contentId?this.currentLibraryWrapper.classList.add("h5p-slide-pseudo"):r?this.currentLibraryWrapper.classList.add("h5p-slide-out-reverse"):this.currentLibraryWrapper.classList.add("h5p-slide-out"),this.overlay&&(null!==this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=void 0,this.branchingQuestions.forEach((function(e){null!==e.parentNode&&e.parentNode.removeChild(e)})),this.showBackgroundToReadspeaker()),this.nextLibraries[t.contentId]||this.createNextLibrary(t);var h=this.nextLibraries[t.contentId];h.offsetParent||this.wrapper.appendChild(h),r&&(h.classList.remove("h5p-next"),h.classList.add("h5p-previous")),h.classList.add("h5p-slide-in");var p=h.getElementsByClassName("h5p-branching-scenario-content")[0];p.classList.remove("h5p-branching-hidden"),this.currentLibraryId=t.contentId,this.currentLibraryInstance=this.libraryInstances[t.contentId],this.currentLibraryInstance.resize&&this.currentLibraryInstance.resize();var b=this;this.currentLibraryWrapper.addEventListener("animationend",(function(){null!==b.currentLibraryWrapper.parentNode&&b.currentLibraryWrapper.parentNode.removeChild(b.currentLibraryWrapper),b.currentLibraryWrapper=h,b.currentLibraryWrapper.classList.remove("h5p-previous"),b.currentLibraryWrapper.classList.remove("h5p-next"),b.currentLibraryWrapper.classList.remove("h5p-slide-in"),b.currentLibraryElement=h.getElementsByClassName("h5p-branching-scenario-content")[0],b.createNextLibraries(t),b.parent.navigating=!1,b.libraryTitle.focus(),l&&b.parent.enableNavButton(),b.resize(new H5P.Event("resize",{element:p}))}))}},e.prototype.hideBackgroundFromReadspeaker=function(){this.header.setAttribute("aria-hidden","true"),this.currentLibraryWrapper.setAttribute("aria-hidden","true")},e.prototype.showBackgroundToReadspeaker=function(){this.header.setAttribute("aria-hidden","false"),this.currentLibraryWrapper.setAttribute("aria-hidden","false")},e.prototype.getElement=function(){return this.wrapper},e.prototype.remove=function(){null!==this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper)},e.prototype.resize=function(e){var t=this.currentLibraryInstance,r=e&&e.data&&e.data.element?e.data.element:this.currentLibraryElement,n=t&&"H5P.Image"===t.libraryInfo.machineName,i=t&&"H5P.CoursePresentation"===t.libraryInfo.machineName,a=t&&"H5P.ImageHotspots"===t.libraryInfo.machineName,s=t&&"H5P.Video"===t.libraryInfo.machineName,o=t&&"H5P.InteractiveVideo"===t.libraryInfo.machineName,c=t&&t.width&&t.height,d=r.classList.contains("h5p-youtube"),l=c&&(n||i)||a||s;if(l&&(r.style.width="",r.style.height="",a&&(r.style.maxWidth="")),this.parent.isFullScreen()){if(r.classList.add("h5p-fullscreen"),o&&t.$videoWrapper[0].firstChild.style&&(t.videoHeight=t.$videoWrapper[0].firstChild.style.height),l){var u=s&&void 0!==this.parent.params.content[this.currentLibraryId].type.params.sources?r.getBoundingClientRect():null;if(s&&void 0===this.parent.params.content[this.currentLibraryId].type.params.sources?r.classList.add("h5p-video-no-source"):r.classList.remove("h5p-video-no-source"),u||a||i||n){var h=a?t.options.image.height:s?u.height:t.height,p=a?t.options.image.width:i?t.ratio*h:s?u.width:t.width,b=h/p,y=o?r.lastChild:r,v=y.getBoundingClientRect();b>v.height/v.width?a?y.style.maxWidth=v.height*(p/h)+"px":y.style.width=v.height*(p/h)+"px":(y.style.height=v.width*b+"px",d&&null!==r.querySelector("iframe")&&(r.querySelector("iframe").style.height=v.width*b+"px"))}}}else{this.parent.startScreen.isShowing?this.resizeScreen(!0):this.overlay?this.resizeScreen():this.wrapper.style.height="";var g=r.getElementsByClassName("h5p-video-wrapper");if(o&&g.length>0){var m=g[0].firstChild;m.style&&(m.style.height=t.videoHeight)}else d&&null!==r.querySelector("iframe")&&(r.querySelector("iframe").style.height="");r.classList.remove("h5p-fullscreen")}t&&(t.trigger("resize",e),this.handleLibraryResize())},e.isBranching=function(e){return!!(e&&e.type&&e.type.library)&&0===e.type.library.indexOf("H5P.BranchingQuestion ")},e.idCounter=0,e}()},451:()=>{H5P.BranchingScenario.LibraryScreenOverlay=function(){function e(e){this.hidden=!0,this.parent=e,this.overlay=document.createElement("div"),this.overlay.classList.add("h5p-content-overlay"),this.overlay.classList.add("h5p-hidden"),this.buttonsContainer=document.createElement("div"),this.buttonsContainer.classList.add("h5p-content-overlay-buttons-container"),this.overlay.appendChild(this.buttonsContainer),this.buttons={}}return e.prototype.getDOM=function(){return this.overlay},e.prototype.show=function(){var e=this;this.overlay.classList.remove("h5p-hidden"),window.requestAnimationFrame((function(){e.buttonsContainer.classList.remove("h5p-hidden"),e.hidden=!1,e.setLibraryTabIndex("-1"),Object.values(e.buttons)[Object.keys(e.buttons).length-1].focus()}))},e.prototype.setLibraryTabIndex=function(e){var t=this.parent.currentLibraryWrapper;t&&t.querySelector("iframe")&&(t.querySelector("iframe").setAttribute("tabindex",e),"H5P.InteractiveVideo"===this.parent.currentLibraryInstance.libraryInfo.machineName&&this.parent.toggleIVTabIndexes(e))},e.prototype.hide=function(){this.hidden=!0,this.overlay.classList.add("h5p-hidden"),this.buttonsContainer.classList.add("h5p-hidden"),this.setLibraryTabIndex("0")},e.prototype.isVisible=function(){return!this.hidden},e.prototype.addButton=function(e,t,r){if(!e&&0!==e||!t||"function"!=typeof r||this.buttons[e])return null;var n=document.createElement("button");return n.classList.add("transition"),n.classList.add("h5p-nav-button"),n.classList.add("h5p-nav-button-".concat(e)),n.innerText=t,n.addEventListener("click",(function(t){r(e)})),this.buttons[e]=n,this.buttonsContainer.appendChild(n),n},e.prototype.removeButton=function(e){(e||0===e)&&this.buttons[e]&&(this.buttonsContainer.removeChild(this.buttons[e]),delete this.buttons[e])},e}()},280:()=>{var e,t;H5P.BranchingScenario.Scoring=(e="static-end-score",t="dynamic-score","no-score",function(r,n){var i=this;i.scores=[],n&&n.scores&&(i.scores=n.scores);var a=i.scores,s=0,o=function(e){return e&&e.feedback&&void 0!==e.feedback.endScreenScore};this.getScore=function(n){return r.scoringOptionGroup.scoringOption===t?a.reduce((function(e,t){return e+t.score}),0):r.scoringOptionGroup.scoringOption===e?n:0},this.getMaxScore=function(){return r.scoringOptionGroup.scoringOption===e?(s=r.endScreens[0].endScreenScore,c=void 0!==s?s:0,r.content.reduce((function(e,t){var r=[t];return i.isBranchingQuestion(t)&&(r=t.type.params.branchingQuestion.alternatives),e.concat(r)}),[]).filter((function(e){return-1===e.nextContentId})).reduce((function(e,t){var r=o(t)?t.feedback.endScreenScore:c;return e>=r?e:r}),0)):r.scoringOptionGroup.scoringOption===t?(n=0,a.forEach((function(e){n+=e.maxScore})),n):0;var n,s,c},this.restart=function(){a=[],s=0},this.addLibraryScore=function(e,t,n,i){s+=1;var c=r.content[e],d=0,l=0;e!==t||0===e&&this.isBranchingQuestion(c)?(d=function(e,t){if(!(t>=0))return 0;if(!(e&&e.type&&e.type.params&&e.type.params.branchingQuestion&&e.type.params.branchingQuestion.alternatives&&e.type.params.branchingQuestion.alternatives[t]))return 0;var r=e.type.params.branchingQuestion.alternatives[t];return!o(r)||void 0===r.nextContentId||r.nextContentId<0?0:r.feedback.endScreenScore}(c,n),l=function(e,t){if(!(t>=0))return 0;var r=e.type.params.branchingQuestion.alternatives,n=0;return r.forEach((function(e,t){r[t].feedback.endScreenScore>n&&-1!==r[t].nextContentId&&(n=r[t].feedback.endScreenScore)})),n}(c,n)):(o(c)&&c.nextContentId&&c.nextContentId>-1&&(d=c.feedback.endScreenScore,l=c.feedback.endScreenScore),r.scoringOptionGroup.includeInteractionsScores&&0!==Object.entries(i).length&&(d+=i.score,l+=i.maxScore));var u=!1,h=null,p=-1;a.forEach((function(t,n){t.id===e&&(t.score=d,t.visitedIndex=s,p=t.visitedIndex,a.length>n+1&&r.content[t.id].nextContentId===a[n+1].id?u=!0:h=n)})),u?(a=a.filter((function(e){return e.visitedIndex<=p})),s=p):(null!==h&&a.splice(h,1),a.push({visitedIndex:s,id:e,score:d,maxScore:l,libraryParams:{subContentId:c.type.subContentId,title:c.type.metadata.title}}))},this.isBranchingQuestion=function(e){var t=e;return e&&e.type&&e.type.library&&(t=e.type.library),"H5P.BranchingQuestion"===t.split(" ")[0]},this.isDynamicScoring=function(){return r.scoringOptionGroup.scoringOption===t},this.isStaticScoring=function(){return r.scoringOptionGroup.scoringOption===e},this.isNoScoring=function(){return"no-score"===r.scoringOptionGroup.scoringOption},this.shouldShowScore=function(){return this.isStaticScoring()||this.isDynamicScoring()}})},20:(e,t)=>{function r(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw s}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i=["H5P.Accordion","H5P.Agamotto","H5P.Audio","H5P.AudioRecorder","H5P.Chart","H5P.Collage","H5P.Dialogcards","H5P.GuessTheAnswer","H5P.Table","H5P.IFrameEmbed","H5P.Image","H5P.ImageHotspots","H5P.Link","H5P.MemoryGame","H5P.Timeline","H5P.TwitterUserFeed","H5P.Video","H5P.PhetInteractiveSimulation","H5P.DocumentationTool","H5P.AdvancedText","H5P.DocumentsUpload","H5P.BranchingQuestion"],a=["H5P.ImageHotspotQuestion","H5P.Blanks","H5P.Essay","H5P.SingleChoiceSet","H5P.MultiChoice","H5P.TrueFalse","H5P.DragQuestion","H5P.Summary","H5P.DragText","H5P.MarkTheWords","H5P.MemoryGame","H5P.QuestionSet","H5P.InteractiveVideo","H5P.CoursePresentation","H5P.DocumentationTool"],s=function(e){if(void 0!==e.isTask)return e.isTask;for(var t=0;t<a.length;t++)if(e.libraryInfo.machineName===a[t])return!0;return!1},o=function(e,t,n){var a="<tbody>";if(e.scoring.isStaticScoring())a+="<tr>",a+="<td>"+n.endScreenText+"</td>",a+='<td style="text-align:right;">'+n.score+"/"+n.maxScore+"</td>",a+="</tr>";else if(e.scoring.isDynamicScoring()){var o,c=r(e.scoring.scores);try{var d=function(){var e=o.value,r=e.libraryParams.subContentId,n=t.filter((function(e){return e.subContentId===r}))[0],c=n.libraryInfo.machineName;if(0===e.score&&0===e.maxScore&&(i.includes(c)||["H5P.InteractiveVideo","H5P.CoursePresentation"].includes(c)&&!s(n)))return"continue";a+="<tr>",a+="<td>"+e.libraryParams.title+"</td>",a+='<td style="text-align:right;">'+e.score+"/"+e.maxScore+"</td>",a+="</tr>"};for(c.s();!(o=c.n()).done;)d()}catch(e){c.e(e)}finally{c.f()}}return'<div class="custom-summary-section"><div class="h5p-summary-table-pages"><table class="h5p-score-table-custom" style="min-height:100px;width:100%;"><thead><tr><th>Content</th><th style="text-align:right;">Score/Total</th></tr></thead>'+(a+="</tbody>")+"</table></div></div>"};function c(e,t,r,n){var i=n.createXAPIEventTemplate("answered");i.setScoredResult(e,t,n),i.data.statement.result.response=r,i.shouldLogStaticScore=!0,n.trigger(i)}t.A=function(e,t,n){if(!t.isStartScreen&&void 0===e.parent.parent&&function(e){return e.scoring&&e.scoring.shouldShowScore()}(e.parent)&&function(e){var t,n=!1,a=r(e.scoring.scores);try{var o=function(){var r=t.value,a=r.libraryParams.subContentId,o=e.instances.filter((function(e){return e.subContentId===a}))[0],c=o.libraryInfo.machineName;if(0===r.score&&0===r.maxScore&&(i.includes(c)||["H5P.InteractiveVideo","H5P.CoursePresentation"].includes(c)&&!s(o)))return"continue";n=!0};for(a.s();!(t=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return n}(e.parent)){var a=document.createElement("button");a.classList.add("h5p-view-summary-button");var d=e.parent.instances,l=e.parent;a.onclick=function(){H5P.jQuery(".submit-answers").remove();var e=new H5P.ConfirmationDialog({headerText:"Branching Scenario Summary",dialogText:o(l,d,t),cancelText:"Cancel",confirmText:"Submit Answers"});e.on("confirmed",(function(){var e=0,n=0;if(l.scoring.isStaticScoring())e+=t.score,n+=t.maxScore,c(e,n,t.endScreenText,l);else if(l.scoring.isDynamicScoring()){var i,a=r(l.scoring.scores);try{var s=function(){var t=i.value;if(0===t.score&&0===t.maxScore)return"continue";e+=t.score,n+=t.maxScore;var r=t.libraryParams.subContentId,a=d.filter((function(e){return e.subContentId===r}))[0];"H5P.BranchingQuestion"===a.libraryInfo.machineName?function(e,t){var r=e.createXAPIEventTemplate("answered");r.data.statement=e.getXAPIData().statement,r.data.statement.result.score={min:0,max:t.maxScore,raw:t.score},t.maxScore>0&&(r.data.statement.result.score.scaled=Math.round(t.score/t.maxScore*1e4)/1e4),r.shouldLogStaticScore=!0,e.trigger(r)}(a,t):function(e,t,r){var n=r.score,i=r.maxScore;e.params.scoringOptionGroup.includeInteractionsScores&&(void 0!==t.getScore&&(n-=t.getScore()),void 0!==t.getMaxScore&&(i-=t.getMaxScore())),c(n,i,"Scenario Score",t)}(l,a,t)};for(a.s();!(i=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}}0===n&&(n+=1),l.triggerXAPIScored(e,n,"submitted-curriki")})),e.appendTo(document.body),e.show()};var u=document.createTextNode("View Summary");a.appendChild(u),n.appendChild(a)}}},734:(e,t,r)=>{"use strict";var n,i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=function(){return"object"===("undefined"==typeof window?"undefined":a(window))},o=s()?window:r.g,c=!!s()&&document.attachEvent,d=!1,l=null,u=null,h=null,p=null,b=function(e){var t=e.__resizeTriggers__,r=t.firstElementChild,n=t.lastElementChild,i=r.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,i.style.width=r.offsetWidth+1+"px",i.style.height=r.offsetHeight+1+"px",r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight},y=(n=o.requestAnimationFrame||o.mozRequestAnimationFrame||o.webkitRequestAnimationFrame||function(e){return setTimeout(e,20)},function(e){return n(e)}),v=(i=o.cancelAnimationFrame||o.mozCancelAnimationFrame||o.webkitCancelAnimationFrame||o.clearTimeout,function(e){return i(e)}),g=function(e){var t=this;b(this),this.__resizeRAF__&&v(this.__resizeRAF__),this.__resizeRAF__=y((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(r){r.call(t,e)})))}))};if(s()&&!c){var m=!1,f="";p="animationstart";var S="Webkit Moz O ms".split(" "),L="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),x=document.createElement("fakeelement");if(void 0!==x.style.animationName&&(m=!0),!1===m)for(var I=0;I<S.length;I++)if(void 0!==x.style[S[I]+"AnimationName"]){f="-"+S[I].toLowerCase()+"-",p=L[I],m=!0;break}u="@"+f+"keyframes "+(l="resizeanim")+" { from { opacity: 0; } to { opacity: 0; } } ",h=f+"animation: 1ms "+l+"; "}t.kp=function(e,t){c?e.attachEvent("onresize",t):s()&&(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),function(){if(!d){var e=(u||"")+".resize-triggers { "+(h||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t.appendChild(r),d=!0}}(),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),b(e),e.addEventListener("scroll",g,!0),p&&e.__resizeTriggers__.addEventListener(p,(function(t){t.animationName==l&&b(e)}))),e.__resizeListeners__.push(t))}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r(330),r(418),r(186),r(451),r(280),r(20)})();